<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cut-Off – Painel Executivo</title>
<style>
:root{
  --bg:#0b1020;--card:#121a33;--muted:#9aa4c0;--text:#e9ecf5;--line:#243055;
}
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#070a14);color:var(--text)}
.wrap{max-width:1200px;margin:0 auto;padding:24px}
.top{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;flex-wrap:wrap}
h1{margin:0;font-size:22px}
.sub{color:var(--muted);font-size:12px;margin-top:6px}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-top:16px}
.card{background:rgba(18,26,51,.92);border:1px solid rgba(36,48,85,.8);border-radius:14px;padding:14px}
.kpi-title{color:var(--muted);font-size:12px}
.kpi-value{font-size:22px;margin-top:8px;font-weight:700}
.kpi-foot{margin-top:6px;color:var(--muted);font-size:12px}
.row{display:grid;grid-template-columns:1.2fr .8fr;gap:12px;margin-top:12px}
@media (max-width: 980px){ .grid{grid-template-columns:repeat(2,1fr)} .row{grid-template-columns:1fr} }
.section-title{margin:0 0 8px 0;font-size:14px}
.note{color:var(--muted);font-size:12px}
.pill{display:inline-block;padding:4px 8px;border-radius:999px;border:1px solid var(--line);color:var(--muted);font-size:11px}
.mini{font-size:11px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">

<div class="top">
  <div>
    <h1>Cut-Off – Painel Executivo</h1>
    <div class="sub">Última atualização: <span id="updatedAt">—</span></div>
  </div>
</div>

<div class="grid" id="kpiGrid"></div>

<div class="row">
  <div class="card">
    <div class="section-title">Resumo histórico – Dezembro</div>
    <div id="yearChart" class="mini">—</div>
  </div>

  <div class="card">
    <div class="section-title">Janeiro – entregas por região</div>
    <div id="regioesJan" style="margin-top:10px"></div>
    <div class="mini" style="margin-top:8px">% Entregue = Entregue ÷ Faturado</div>
  </div>
</div>

<script>
function brl(v){
  return Number(v||0).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
}
function pct(a,b){
  if(!b) return '0,00%';
  return ((a/b)*100).toFixed(2).replace('.',',')+'%';
}

async function load(){
  const r = await fetch('./data.json?v='+Date.now(),{cache:'no-store'});
  const data = await r.json();

  document.getElementById('updatedAt').textContent = data.updated_at;

  const k = data.kpis;
  const cards = [
    {t:'Valor faturado (Dez)', v: brl(k.valor_faturado_dez)},
    {t:'Valor entregue (Dez)', v: brl(k.valor_entregue_dez)},
    {t:'Entrega prevista – Dez', v: brl(k.valor_previsto_dez)},
    {t:'Entrega prevista – Jan', v: brl(k.valor_previsto_jan)}
  ];

  document.getElementById('kpiGrid').innerHTML = cards.map(c=>`
    <div class="card">
      <div class="kpi-title">${c.t}</div>
      <div class="kpi-value">${c.v}</div>
    </div>
  `).join('');

  document.getElementById('regioesJan').innerHTML =
    data.regioes_janeiro.map(r=>`
      <div style="margin-bottom:8px">
        <span class="pill">${r.regiao}</span>
        <div class="mini">Faturado: <b>${brl(r.valor_faturado)}</b></div>
        <div class="mini">Entregue: <b>${brl(r.valor_entregue)}</b></div>
        <div><b>${pct(r.valor_entregue,r.valor_faturado)}</b></div>
      </div>
    `).join('');
}

load();
</script>

</body>
</html>
